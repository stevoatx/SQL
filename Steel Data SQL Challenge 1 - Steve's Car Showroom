#1. What are the details of all cars purchased in the year 2022?

SELECT 
  c.car_id, 
  c.make, 
  c.type, 
  c.style, 
  c.cost_$, 
  s.purchase_date 
FROM 
  cars c 
  JOIN sales s ON c.car_id = s.car_id 
WHERE 
  purchase_date LIKE '2022%'
ORDER BY 
  c.car_id


#2. What is the total number of cars sold by each salesperson?

  SELECT 
  sp.name, 
  COUNT (s.sale_id) 'number_of_sales' 
FROM 
  sales s 
  JOIN salespersons sp ON sp.salesman_id = s.salesman_id 
GROUP BY 
  sp.name 
ORDER BY 
  COUNT (s.sale_id)

#3. What is the total revenue generated by each salesperson?

SELECT 
  s.salesman_id, 
  sp.name, 
  SUM(c.cost_$) AS total_revenue 
FROM 
  sales s 
  INNER JOIN salespersons sp USING(salesman_id) 
  INNER JOIN cars c USING (car_id) 
GROUP BY 
  s.salesman_id, 
  sp.name 
ORDER BY 
  s.salesman_id

#4. What are the details of the cars sold by each salesperson?

SELECT 
  s.salesman_id, 
  sp.name c.car_id, 
  c.make, 
  c.type, 
  c.style, 
  c.cost_$ 
FROM 
  sales s 
  INNER JOIN salespersons sp USING(salesman_id) 
  INNER JOIN cars c USING(car_id) 
GROUP BY 
  s.salesman_id, 
  sp.name, 
  c.car_id 
ORDER BY 
  s.salesman_id, 
  c.car_id

#5. What is the total revenue generated by each car type?

SELECT s.car_id,
  c.type,
  SUM(c.cost_$) AS total_revenue
FROM
  sales s
  INNER JOIN cars c USING(car_id)
GROUP BY
  s.car_id, c.type
ORDER BY
  s.car_id

#6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

SELECT 
  s.car_id, 
  s.salesman_id, 
  sp.name, 
  YEAR(s.purchase_date) as selling_year, 
  c.make, 
  c.type, 
  c.style, 
  c.cost_$ 
FROM 
  sales s 
  INNER JOIN salespersons sp USING (salesman_id) 
  INNER JOIN cars c USING(car_id) 
WHERE 
  sp.name = "Emily Wong" 
  AND YEAR(s.purchase_date) = 2021 
ORDER BY 
  s.car_id

#7. What is the total revenue generated by the sales of hatchback cars?

SELECT 
  s.car_id, 
  c.style, 
  SUM(c.cost_$) AS total_revenue 
FROM 
  sales s 
  INNER JOIN cars c USING(car_id) 
WHERE 
  c.style = "Hatchback" 
GROUP BY 
  s.car_id

#8. What is the total revenue generated by the sales of SUV cars in the year 2022?

SELECT 
  SUM(total_revenue) AS total_SUV_revenue2021 
FROM 
  (
    SELECT 
      s.car_id, 
      c.style, 
      SUM(c.cost_$) AS total_revenue 
    FROM 
      sales s 
      INNER JOIN cars c USING(car_id) 
    WHERE 
      c.style = "SUV" 
      AND YEAR(s.purchase_date) = 2021 
    GROUP BY 
      s.car_id, 
      c.style
  ) AS T;

 #9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?
 
 SELECT 
  s.salesman_id, 
  sp.name, 
  sp.city, 
  COUNT(s.car_id) as total_car_sold_in_2023 
FROM 
  sales s 
  INNER JOIN salespersons sp USING(saleman_id) 
WHERE 
  YEAR(s.purchase_date) = 2023 
GROUP BY 
  s.salesman_id, 
  sp.name 
ORDER BY 
  COUNT(s.car_id) DESC 
LIMIT 
  1

#10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?

SELECT 
  s.salesman_id, 
  sp.name, 
  sp.age, 
  SUM(c.cost_$) AS total_revenue_in_2022 
FROM 
  sales s 
  INNER JOIN salespersons sp USING(salesman_id) 
  INNER JOIN cars c USING(car_id) 
WHERE 
  YEAR(s.purchase_date) = 2022 
GROUP BY 
  s.salesman_id, 
  sp.name 
ORDER BY 
  SUM(c.cost_$) DESC 
LIMIT 
  1
